<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[Docker 部署安装Mautic]]></title>
    <url>%2F2020%2F01%2F17%2FDocker-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85Mautic%2F</url>
    <content type="text"><![CDATA[docker下部署Mautic]]></content>
      <categories>
        <category>confluence</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Docker 部署安装Confluence]]></title>
    <url>%2F2020%2F01%2F17%2FDocker-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85Confluence%2F</url>
    <content type="text"><![CDATA[docker下部署confluence docker镜像获取及容器创建 confluence镜像下载 1docker pull cptactionhank/atlassian-confluence 创建confluence容器 1234567docker run -d \--restart=always \--name &quot;confluence&quot; \-p 7788:8090 \-e CATALINA_OPTS=&quot;-Xms512m -Xmx4g&quot; \-v confluence:/var/atlassian/confluence \cptactionhank/atlassian-confluence:latest 命令详解: -d 即 –detach 设置容器后台运行 –restart=always Docker重启时自动启动容器 –name 容器别名 -p 即 –publish 宿主机端口:容器内部端口 容器内部端口映射到宿主机 -e 即 –env 创建容器时传入环境变量 -v 即 –volume 宿主机路径(或者匿名的volume 使用命令: docker volume ls 可查看所有volume,使用命令: docker inspect [volume] 查看文件内容):容器路径 将容器内部文件映射到宿主机目录下 查看容器运行状态&amp;进入容器内部 查看容器运行状态 1docker ps -a 进入容器内部,退出: exit 1docker exec -it [容器名或者ID] /bin/sh 配置confluence 访问http://ip:7788 就可以看到Confluence的初始化和配置页面。右上角语言栏选择中文 一路next 记住这个服务ID,进入破解流程:confluence破解 输入上一步破解教程得到的Key 开始配置数据库 1jdbc:mysql://192.168.1.202:3308/test_confluence?useUnicode=true&amp;amp;characterEncoding=utf8&amp;amp;useSSL=false&amp;amp;sessionVariables=tx_isolation=&apos;READ-COMMITTED&apos; 如果出现隔离级别错误,设置数据库默认隔离级别为 1SET GLOBAL TRANSACTION ISOLATION LEVEL READ COMMITTED; confluence开始创建表 完成安装个人推荐选择空白站点 confluence破解 破解文件下载:confluence破解.rar 破解文件的使用: (1). 解压文件 如上图所示图片,邮件打开方式选择java (2). 破解文件下载到windows机器将atlassian-extras-decoder-v2-3.4.1.jar复制到宿主机并重命名为atlassian-extras-2.4.jar(破解文件只识别此名字)sz 命令将atlassian-extras-2.4.jar 下载到本地进行破解 123docker cp confluence:/opt/atlassian/confluence/confluence/WEB-INF/lib/atlassian-extras-decoder-v2-3.4.1.jar ./atlassian-extras-2.4.jar sz atlassian-extras-2.4.jar (3).破解 将生成的atlassian-extras-2.4.jar上传到服务器(如linux路径下有同名文件需要先重命名)1rz 选择atlassian-extras-2.4.jar进行上传 用上传的文件替换confluence中的atlassian-extras-decoder-v2-3.4.1.jar 1docker cp ./atlassian-extras-2.4.jar confluence:/opt/atlassian/confluence/confluence/WEB-INF/lib/atlassian-extras-decoder-v2-3.4.1.jar 重启容器 1docker restart confluence 复制破解脚本中Key值,重新进入confluence安装教程 常见错误处理 Mysql Session isolation level 错误 数据库链接中加入参数:useSSL=false mysql重启导致隔离级别需要重新设置 数据库链接中加入参数:sessionVariables=tx_isolation=’READ-COMMITTED’]]></content>
      <categories>
        <category>confluence</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA['Java基础-基本数据类型']]></title>
    <url>%2F2019%2F11%2F11%2FJava%E5%9F%BA%E7%A1%80-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%2F</url>
    <content type="text"><![CDATA[Java基本结构及基本数据类型 基本结构大致分为包、类、main()方法、标识符、关键字、语句、注释等 12345678910111213141516171819202122package com.howard.test;public class Main &#123; public static void main(String[] args) &#123; /* 整数类型 */ byte myByte = 45; // byte型变量，占一个字节，取值范围-128~127 short myShort = 100; // short型变量，也即短整型，占两个字节，取值范围-32768~32767 int myInt = 450; // int型变量，也即整型，占四个字节，取值范围-2147483648~2147483647 long myLong = 45261636L; // long型变量，也即长整型，占八个字节，取值范围-9223372036854775808~9223372036854775807 /* 浮点类型 */ float myFloat = 15.621F; // 单精度浮点型，占四个字节，结尾必须加&apos;F&apos;或&apos;f&apos;，如果不加自动定义为double型变量，取值范围1.4E-45~3.4028235E-38 double myDouble = 15.621D; // 双精度浮点型，占八个字节，结尾可以加&apos;D&apos;或&apos;d&apos;，也可不加，取值范围4.9E-324~1.7976931348623157E-308 /* 字符类型 */ char myChar = &apos;a&apos;; // 字符类型变量，用于存储单个字符，占两个字节，需用单引号括起来 /* 布尔类型 */ boolean myBoolean = true; // 布尔类型又称逻辑类型，只有true和false两个值，分别代表“真”和“假” &#125;&#125;]]></content>
      <categories>
        <category>Java基础</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RabbitMQ配置留档]]></title>
    <url>%2F2019%2F10%2F15%2FRabbit%E7%95%99%E6%A1%A3%2F</url>
    <content type="text"><![CDATA[RabbitMQ消息队列基本操作RabbitMQ操作 进入安装目录sbin文件夹下运行,也可以开启web插件,在界面用guest/guest添加账号 启动RabbitMQ管理页面1rabbitmq-plugins.bat enable rabbitmq_management 删除已安装的RabbitMQ服务1rabbitmq-service.bat remove 设置新路径1set RABBITMQ_BASE=D:\RabbitMQ\Data 重新安装RabbitMQ服务1rabbitmq-service.bat install 启动服务1rabbitmq-service.bat start 添加用户1rabbitmqctl.bat add_user rabbitmquser 123456 赋角色1rabbitmqctl.bat set_user_tags rabbitmquser administrator 赋权1rabbitmqctl.bat set_permissions -p / rabbitmquser &apos;.*&apos; &apos;.*&apos; &apos;.*&apos; 删除默认guest用户1rabbitmqctl.bat delete_user guest 修改端口号 Win安装后会在 C:\Users\LongQi-Howard\AppData\Roaming\RabbitMQ生成配置文件.example,修改 tcp_listeners 字段,之后先停止-重装-开启rabbit服务即可修改端口号 #修改]]></content>
      <categories>
        <category>RabbitMQ</category>
        <category>消息队列</category>
      </categories>
      <tags>
        <tag>RabbitMQ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mybatis一对多映射]]></title>
    <url>%2F2019%2F08%2F29%2Fmybatis%E4%B8%80%E5%AF%B9%E5%A4%9A%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%2F</url>
    <content type="text"><![CDATA[注意事项 启动类加上MapperScan 映射文件路径配置要对应到生成的Mapper.xml文件 application.yml配置文件123456789spring: datasource: driver-class-name: com.microsoft.sqlserver.jdbc.SQLServerDriver username: sa password: longqi.123 url: jdbc:sqlserver://localhost:8888;database=shiromybatis: mapper-locations: classpath:mappers/*Mapper.xml type-aliases-package: com.howard.shiro.shiro.mappers mybatis可以根据ResultMap映射一对多 自动生成实体类后,在实体类里添加关联表实体1234567891011121314151617181920212223242526@Datapublic class UserInfoEntity &#123; private Integer userId; private String userName; private String password; private String salt; private String email; private Integer status; private Date lastLoginTime; private Date createTime; private Date modifyTime; private String activeCode; private Integer deptId; private List&lt;RoleEntity&gt; roles; &#125; 在UserMapper.xml的ResultMap标签里配置collection标签123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960UserMapper.xml&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;&lt;mapper namespace=&quot;com.howard.shiro.shiro.mapper.UserInfoEntityMapper&quot;&gt; &lt;resultMap id=&quot;BaseResultMap&quot; type=&quot;com.howard.shiro.shiro.entity.UserInfoEntity&quot;&gt; &lt;id column=&quot;user_id&quot; jdbcType=&quot;INTEGER&quot; property=&quot;userId&quot; /&gt; &lt;result column=&quot;user_name&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;userName&quot; /&gt; &lt;result column=&quot;password&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;password&quot; /&gt; &lt;result column=&quot;salt&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;salt&quot; /&gt; &lt;result column=&quot;email&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;email&quot; /&gt; &lt;result column=&quot;status&quot; jdbcType=&quot;INTEGER&quot; property=&quot;status&quot; /&gt; &lt;result column=&quot;last_login_time&quot; jdbcType=&quot;TIMESTAMP&quot; property=&quot;lastLoginTime&quot; /&gt; &lt;result column=&quot;create_time&quot; jdbcType=&quot;TIMESTAMP&quot; property=&quot;createTime&quot; /&gt; &lt;result column=&quot;modify_time&quot; jdbcType=&quot;TIMESTAMP&quot; property=&quot;modifyTime&quot; /&gt; &lt;result column=&quot;active_code&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;activeCode&quot; /&gt; &lt;result column=&quot;dept_id&quot; jdbcType=&quot;INTEGER&quot; property=&quot;deptId&quot; /&gt; &lt;/resultMap&gt; &lt;resultMap id=&quot;BaseRoleResultMap&quot; type=&quot;com.howard.shiro.shiro.entity.RoleEntity&quot;&gt; &lt;id column=&quot;role_id&quot; jdbcType=&quot;INTEGER&quot; property=&quot;roleId&quot; /&gt; &lt;result column=&quot;role_name&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;roleName&quot; /&gt; &lt;result column=&quot;remark&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;remark&quot; /&gt; &lt;result column=&quot;create_time&quot; jdbcType=&quot;TIMESTAMP&quot; property=&quot;createTime&quot; /&gt; &lt;result column=&quot;modify_time&quot; jdbcType=&quot;TIMESTAMP&quot; property=&quot;modifyTime&quot; /&gt; &lt;/resultMap&gt; &lt;resultMap id=&quot;UserRolePermResultMap&quot; type=&quot;com.howard.shiro.shiro.entity.UserInfoEntity&quot; extends=&quot;BaseResultMap&quot;&gt; &lt;collection property=&quot;roles&quot; ofType=&quot;com.howard.shiro.shiro.entity.RoleEntity&quot; select=&quot;selectAllRoleByUserId&quot; column=&quot;user_id&quot;/&gt; &lt;!--extend标识继承 select标签对应子查询语句,column标签对应传递的值 --&gt; &lt;/resultMap&gt; &lt;sql id=&quot;Base_Column_List&quot;&gt; user_id, user_name, password, salt, email, status, last_login_time, create_time, modify_time, active_code, dept_id &lt;/sql&gt; &lt;sql id=&quot;Base_Role_List&quot;&gt; role.role_id, role.role_name, role.remark, role.create_time, role.modify_time &lt;/sql&gt; &lt;select id=&quot;selectAllRoleByUserId&quot; resultMap=&quot;BaseRoleResultMap&quot; parameterType=&quot;java.lang.Integer&quot;&gt; select &lt;include refid=&quot;Base_Role_List&quot;/&gt; from user_role inner join role ON user_role.role_id = role.role_id where user_role.user_id = #&#123;user_id&#125; &lt;/select&gt; &lt;select id=&quot;selectUserInfoRoleByUserName&quot; parameterType=&quot;java.lang.String&quot; resultMap=&quot;UserRolePermResultMap&quot;&gt; select &lt;include refid=&quot;Base_Column_List&quot;/&gt; from user_info where user_name=#&#123;userName&#125; &lt;/select&gt;&lt;/mapper&gt;]]></content>
      <categories>
        <category>SpringBoot</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>MyBatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mybatis逆向生成工程]]></title>
    <url>%2F2019%2F08%2F28%2Fmybatis%E9%80%86%E5%90%91%E7%94%9F%E6%88%90%2F</url>
    <content type="text"><![CDATA[使用maven插件实现pom文件引入依赖 逆向生成依赖12345&lt;dependency&gt; &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt; &lt;artifactId&gt;mybatis-generator-core&lt;/artifactId&gt; &lt;version&gt;1.3.7&lt;/version&gt;&lt;/dependency&gt; 逆向生成maven插件123456789101112&lt;plugin&gt; &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt; &lt;artifactId&gt;mybatis-generator-maven-plugin&lt;/artifactId&gt; &lt;version&gt;1.3.7&lt;/version&gt; &lt;configuration&gt; &lt;configurationFile&gt; $&#123;basedir&#125;/src/main/resources/generator/generatorConfig.xml &lt;/configurationFile&gt; &lt;overwrite&gt;true&lt;/overwrite&gt; &lt;verbose&gt;true&lt;/verbose&gt; &lt;/configuration&gt; &lt;/plugin&gt; configurationFile逆向工程配置文件地址,地址可以按照自己的想法写 配置文件123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE generatorConfiguration PUBLIC &quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;&gt;&lt;generatorConfiguration&gt; &lt;!-- 数据库驱动:选择你的本地硬盘上面的数据库驱动包--&gt; &lt;classPathEntry location=&quot;C:\Users\LongQi-Howard\Downloads\mssql-jdbc-6.4.0.jre8.jar&quot;/&gt; &lt;context id=&quot;DB2Tables&quot; targetRuntime=&quot;MyBatis3&quot;&gt; &lt;commentGenerator&gt; &lt;property name=&quot;suppressDate&quot; value=&quot;true&quot;/&gt; &lt;!-- 是否去除自动生成的注释 true：是 ： false:否 --&gt; &lt;property name=&quot;suppressAllComments&quot; value=&quot;true&quot;/&gt; &lt;/commentGenerator&gt; &lt;!--数据库链接URL，用户名、密码 --&gt; &lt;jdbcConnection driverClass=&quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot; connectionURL=&quot;jdbc:sqlserver://218.28.44.115:8888;database=shiro&quot; userId=&quot;sa&quot; password=&quot;longqi.123&quot;&gt; &lt;/jdbcConnection&gt; &lt;javaTypeResolver&gt; &lt;property name=&quot;forceBigDecimals&quot; value=&quot;false&quot;/&gt; &lt;/javaTypeResolver&gt; &lt;!-- 生成实体类的包名和位置--&gt; &lt;javaModelGenerator targetPackage=&quot;com.howard.shiro.shiro.entity&quot; targetProject=&quot;src/main/java&quot;&gt; &lt;!-- enableSubPackages:是否让schema作为包的后缀 --&gt; &lt;property name=&quot;enableSubPackages&quot; value=&quot;false&quot;/&gt; &lt;!-- 从数据库返回的值被清理前后的空格 --&gt; &lt;property name=&quot;trimStrings&quot; value=&quot;true&quot;/&gt; &lt;/javaModelGenerator&gt; &lt;!-- 生成Mapper.xml的包名和位置--&gt; &lt;sqlMapGenerator targetPackage=&quot;mappers&quot; targetProject=&quot;./src/main/resources&quot;&gt; &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot;/&gt; &lt;/sqlMapGenerator&gt; &lt;!-- 生成mapper接口的位置--&gt; &lt;javaClientGenerator type=&quot;XMLMAPPER&quot; targetPackage=&quot;com.howard.shiro.shiro.mapper&quot; targetProject=&quot;src/main/java&quot;&gt; &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot;/&gt; &lt;/javaClientGenerator&gt; &lt;!-- 要生成的表 tableName是数据库中的表名或视图名 domainObjectName是实体类名--&gt;&lt;!-- &lt;table tableName=&quot;user_info&quot; domainObjectName=&quot;UserInfoEntity&quot;--&gt;&lt;!-- enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;&lt;!-- enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;&lt;!-- selectByExampleQueryId=&quot;false&quot;&gt;--&gt;&lt;!-- &lt;/table&gt;--&gt;&lt;!-- &lt;table tableName=&quot;user_role&quot; domainObjectName=&quot;UserRoleEntity&quot;--&gt;&lt;!-- enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;&lt;!-- enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;&lt;!-- selectByExampleQueryId=&quot;false&quot;&gt;--&gt;&lt;!-- &lt;/table&gt;--&gt;&lt;!-- &lt;table tableName=&quot;role_operator&quot; domainObjectName=&quot;RoleOperatorEntity&quot;--&gt;&lt;!-- enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;&lt;!-- enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;&lt;!-- selectByExampleQueryId=&quot;false&quot;&gt;--&gt;&lt;!-- &lt;/table&gt;--&gt;&lt;!-- &lt;table tableName=&quot;role_menu&quot; domainObjectName=&quot;RoleMenuEntity&quot;--&gt;&lt;!-- enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;&lt;!-- enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;&lt;!-- selectByExampleQueryId=&quot;false&quot;&gt;--&gt;&lt;!-- &lt;/table&gt;--&gt;&lt;!-- &lt;table tableName=&quot;role&quot; domainObjectName=&quot;RoleEntity&quot;--&gt;&lt;!-- enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;&lt;!-- enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;&lt;!-- selectByExampleQueryId=&quot;false&quot;&gt;--&gt;&lt;!-- &lt;/table&gt;--&gt;&lt;!-- &lt;table tableName=&quot;operator&quot; domainObjectName=&quot;OperatorEntity&quot;--&gt;&lt;!-- enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;&lt;!-- enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;&lt;!-- selectByExampleQueryId=&quot;false&quot;&gt;--&gt;&lt;!-- &lt;/table&gt;--&gt;&lt;!-- &lt;table tableName=&quot;menu&quot; domainObjectName=&quot;MenuEntity&quot;--&gt;&lt;!-- enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;&lt;!-- enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;&lt;!-- selectByExampleQueryId=&quot;false&quot;&gt;--&gt;&lt;!-- &lt;/table&gt;--&gt;&lt;!-- &lt;table tableName=&quot;dept&quot; domainObjectName=&quot;DeptEntity&quot;--&gt;&lt;!-- enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;&lt;!-- enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;&lt;!-- selectByExampleQueryId=&quot;false&quot;&gt;--&gt;&lt;!-- &lt;/table&gt;--&gt; &lt;/context&gt;&lt;/generatorConfiguration&gt; 然后运行maven插件下的 mybatis-generator:generator]]></content>
      <categories>
        <category>SpringBoot</category>
        <category>SSM</category>
      </categories>
      <tags>
        <tag>MyBatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[shiro配置留档]]></title>
    <url>%2F2019%2F08%2F28%2FSpringBoot%2BShiro%2F</url>
    <content type="text"><![CDATA[Shiro配置shiro核心配置类MyShiroRealm 继承 AuthorizingRealm 重写doGetAuthorizationInfo(授权),doGetAuthenticationInfo(鉴权)方法 MyShiroRealm123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051@Override/** * create by: liumeng * description: 授权 * create time: 2019/8/29 14:21 * @param ： principalCollection * @return : org.apache.shiro.authz.AuthorizationInfo */protected AuthorizationInfo doGetAuthorizationInfo(PrincipalCollection principalCollection) &#123; UserInfoEntity user = (UserInfoEntity) principalCollection.getPrimaryPrincipal(); String userName = user.getUserName(); UserInfoEntity userInfoEntity = userService.getAllUserInfoByUserName(userName); Set&lt;String&gt; roles = new HashSet&lt;&gt;(); Set&lt;String&gt; perms = new HashSet&lt;&gt;(); for (RoleEntity roleEntity : userInfoEntity.getRoles()) &#123; roles.add(roleEntity.getRoleName()); for (MenuEntity menu : roleEntity.getMenus()) &#123; perms.add(menu.getPerms()); &#125; for (OperatorEntity operatorEntity : roleEntity.getOperators()) &#123; perms.add(operatorEntity.getPerms()); &#125; &#125; SimpleAuthorizationInfo authorizationInfo = new SimpleAuthorizationInfo(); authorizationInfo.setRoles(roles); authorizationInfo.setStringPermissions(perms); return authorizationInfo;&#125; @Override/** * create by: liumeng * description: 鉴权 * create time: 2019/8/29 15:11 * @param ： authenticationToken * @return : org.apache.shiro.authc.AuthenticationInfo */protected AuthenticationInfo doGetAuthenticationInfo(AuthenticationToken authenticationToken) throws AuthenticationException &#123; String userName = (String) authenticationToken.getPrincipal(); UserInfoEntity userInfoEntity = userService.getUserInfoByUserName(userName); if (userInfoEntity == null) &#123; throw new UnknownAccountException("账号不存在"); &#125; if (userInfoEntity.getStatus() == 0)&#123; throw new LockedAccountException("账号被锁定"); &#125; return new SimpleAuthenticationInfo(userInfoEntity, userInfoEntity.getPassword(), ByteSource.Util.bytes(userInfoEntity.getSalt()), super.getName());&#125; userService1234567891011121314151617181920212223242526272829303132333435@Resourceprivate UserInfoEntityMapper userMapper;@Resourceprivate RoleEntityMapper roleMapper;@Resourceprivate OperatorEntityMapper operatorMapper;@Resourceprivate MenuEntityMapper menuMapper;@Value("$&#123;shiro.admin&#125;")private String adminUser; @Overridepublic UserInfoEntity getAllUserInfoByUserName(String userName) &#123; UserInfoEntity userInfoEntity = userMapper.selectAllUserInfoByUserName(userName); if (userName.equals(adminUser)) &#123; //超级管理员账号获取所有角色和权限 List&lt;RoleEntity&gt; roleEntities = roleMapper.selectAllRoles(); List&lt;MenuEntity&gt; menuEntities = menuMapper.selectAllMenu(); List&lt;OperatorEntity&gt; operatorEntities = operatorMapper.selectAllOperator(); roleEntities.get(0).setMenus(menuEntities); roleEntities.get(0).setOperators(operatorEntities); userInfoEntity.setRoles(roleEntities); &#125; return userInfoEntity;&#125;@Overridepublic UserInfoEntity getUserInfoByUserName(String userName) &#123; return userMapper.selectUserInfoByUserName(userName);&#125; ShiroConfig shiro核心配置类 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119@Bean /** * create by: liumeng * description: 开启thymeleaf shiro标签 支持 * create time: 2019/8/29 15:19 * @param ： * @return : at.pollux.thymeleaf.shiro.dialect.ShiroDialect */ public ShiroDialect shiroDialect()&#123; return new ShiroDialect(); &#125; @Bean /** * create by: liumeng * description: 密码匹配器 * create time: 2019/8/29 14:14 * @param ： * @return : org.apache.shiro.authc.credential.HashedCredentialsMatcher */ public HashedCredentialsMatcher hashedCredentialsMatcher()&#123; HashedCredentialsMatcher hashedCredentialsMatcher = new HashedCredentialsMatcher(); hashedCredentialsMatcher.setHashAlgorithmName("md5"); //散列次数 hashedCredentialsMatcher.setHashIterations(2); return hashedCredentialsMatcher; &#125; @Bean /** * create by: liumeng * description: 自定义Shiro域 * create time: 2019/8/29 15:16 * @param ： * @return : com.shiro.howard.lm.config.MyShiroRealm */ public MyShiroRealm myShiroRealm()&#123; MyShiroRealm myShiroRealm = new MyShiroRealm(); //注入自定义密码匹配器 myShiroRealm.setCredentialsMatcher(hashedCredentialsMatcher()); return myShiroRealm; &#125; @Bean /** * create by: liumeng * description: 注入securityManager * create time: 2019/8/29 15:18 * @param ： * @return : org.apache.shiro.mgt.SecurityManager */ public SecurityManager securityManager()&#123; DefaultWebSecurityManager securityManager = new DefaultWebSecurityManager(); securityManager.setRealm(myShiroRealm()); return securityManager; &#125; @Bean /** * create by: liumeng * description: 配置Shiro过滤规则 * create time: 2019/8/29 15:22 * @param ： securityManager * @return : org.apache.shiro.spring.web.ShiroFilterFactoryBean */ public ShiroFilterFactoryBean shiroFilterFactoryBean(SecurityManager securityManager)&#123; ShiroFilterFactoryBean shiroFilterFactoryBean = new ShiroFilterFactoryBean(); shiroFilterFactoryBean.setSecurityManager(securityManager); //配置拦截器 Map&lt;String,String&gt; filterMap = new LinkedHashMap&lt;&gt;(); filterMap.put("/favicon.ico", "anon"); filterMap.put("/css/**", "anon"); filterMap.put("/fonts/**", "anon"); filterMap.put("/images/**", "anon"); filterMap.put("/js/**", "anon"); filterMap.put("/lib/**", "anon"); filterMap.put("/login", "anon"); filterMap.put("/register", "anon"); filterMap.put("/403", "anon"); filterMap.put("/404", "anon"); filterMap.put("/500", "anon"); filterMap.put("/error", "anon"); filterMap.put("/login","anon"); filterMap.put("/logout","logout"); filterMap.put("/**","authc"); shiroFilterFactoryBean.setLoginUrl("/login"); shiroFilterFactoryBean.setSuccessUrl("/index"); shiroFilterFactoryBean.setUnauthorizedUrl("/403"); shiroFilterFactoryBean.setFilterChainDefinitionMap(filterMap); return shiroFilterFactoryBean; &#125; @Bean /** * create by: liumeng * description: 开启AOP注解 * create time: 2019/8/29 15:24 * @param ： securityManager * @return : org.apache.shiro.spring.security.interceptor.AuthorizationAttributeSourceAdvisor */ public AuthorizationAttributeSourceAdvisor authorizationAttributeSourceAdvisor(SecurityManager securityManager)&#123; AuthorizationAttributeSourceAdvisor authorizationAttributeSourceAdvisor = new AuthorizationAttributeSourceAdvisor(); authorizationAttributeSourceAdvisor.setSecurityManager(securityManager); return authorizationAttributeSourceAdvisor; &#125; @Bean /** * create by: liumeng * description: 扫描上下文，寻找所有的Advistor(通知器） * 将这些Advisor应用到所有符合切入点的Bean中。 * create time: 2019/8/29 15:25 * @param ： * @return : org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator */ public DefaultAdvisorAutoProxyCreator defaultAdvisorAutoProxyCreator()&#123; DefaultAdvisorAutoProxyCreator defaultAdvisorAutoProxyCreator=new DefaultAdvisorAutoProxyCreator(); defaultAdvisorAutoProxyCreator.setProxyTargetClass(true); return defaultAdvisorAutoProxyCreator; &#125;]]></content>
      <categories>
        <category>SpringBoot</category>
        <category>Shiro</category>
      </categories>
      <tags>
        <tag>Shiro</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[库存同步]]></title>
    <url>%2F2019%2F02%2F25%2FU8ERP%2F</url>
    <content type="text"><![CDATA[库存同步背景公司自研ORP(订单资源管理平台)上线后，公司对库存的管理做了相应的调整,工厂使用用友U8系统进行生产和成品库存管理，销售公司订单部进行销售发货是使用公司自研的订单ERP系统完成货运匹配、订单处理、打包发货等操作.为了实现两套系统中的库存同步，在各自系统中建立了同样的仓库，并靠人工每天将产生的订单进行导入或录入达到库存同步的目的,这种库存同步的方式耗费人工的且库存时效性低，因此需进行系统之间的数据集成，达到数据时效性和降低人工成本的目的 目标在保证系统稳定的前提下实现库存的自动同步,提高同步的时效性 技术选取1.U8到中间件的数据同步,采用数据库触发器的方式写入中间件数据库.当有新数据插入的时候会触发触发器,开始往中间件数据库写入数据.2.为了保证数据传输的可靠性,中间件与ORP的通信采用消息队列方式实现,并开启ACK验证,消息持久化. 系统时序图U8同步库存到ERP序列图12345678sequenceDiagram participant U8 participant 中间件 participant ERP U8-&gt;&gt;中间件:新的出入库记录(排除ERP同步订单) 中间件-&gt;&gt;ERP:发送新的库存变更记录 ERP-&gt;&gt;中间件:返回同步结果 note left of 中间件:更新中间件数据库状态 ERP出入库记录同步到U81234567sequenceDiagram participant U8 participant 中间件 participant ERP ERP-&gt;&gt;中间件:出入库记录及详情 中间件-&gt;&gt;U8:调用存储过程在U8数据库生成发货单和出库单 U8-&gt;&gt;中间件:返回单据号和其他信息回写到中间件 总结]]></content>
      <categories>
        <category>U8库存同步</category>
        <category>系统设计</category>
      </categories>
      <tags>
        <tag>U8库存同步</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2019%2F02%2F21%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
  </entry>
</search>
