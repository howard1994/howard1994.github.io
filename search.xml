<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Hello World</title>
      <link href="/2020/01/19/hello-world/"/>
      <url>/2020/01/19/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.<br><a id="more"></a></p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Docker 部署安装Mautic</title>
      <link href="/2020/01/17/Docker-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85Mautic/"/>
      <url>/2020/01/17/Docker-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85Mautic/</url>
      
        <content type="html"><![CDATA[<h1 id="docker下部署Mautic"><a href="#docker下部署Mautic" class="headerlink" title="docker下部署Mautic"></a>docker下部署Mautic</h1>]]></content>
      
      
      <categories>
          
          <category> confluence </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker 部署安装Confluence</title>
      <link href="/2020/01/17/Docker-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85Confluence/"/>
      <url>/2020/01/17/Docker-%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85Confluence/</url>
      
        <content type="html"><![CDATA[<h1 id="docker下部署confluence"><a href="#docker下部署confluence" class="headerlink" title="docker下部署confluence"></a>docker下部署confluence</h1><a id="more"></a><h2 id="docker镜像获取及容器创建"><a href="#docker镜像获取及容器创建" class="headerlink" title="docker镜像获取及容器创建"></a>docker镜像获取及容器创建</h2><ul><li><ol><li><p>confluence镜像下载</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull cptactionhank/atlassian-confluence</span><br></pre></td></tr></table></figure>   </li></ol></li><li><ol start="2"><li><p>创建confluence容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">--restart=always \</span><br><span class="line">--name &quot;confluence&quot;  \</span><br><span class="line">-p 7788:8090 \</span><br><span class="line">-e CATALINA_OPTS=&quot;-Xms512m -Xmx4g&quot; \</span><br><span class="line">-v confluence:/var/atlassian/confluence \</span><br><span class="line">cptactionhank/atlassian-confluence:latest</span><br></pre></td></tr></table></figure><p>命令详解:</p><ul><li>-d 即 –detach <strong>设置容器后台运行</strong></li><li>–restart=always  <strong>Docker重启时自动启动容器</strong></li><li>–name  <strong>容器别名</strong></li><li>-p 即 –publish <strong>宿主机端口:容器内部端口 容器内部端口映射到宿主机</strong></li><li>-e 即 –env <strong>创建容器时传入环境变量</strong></li><li>-v 即 –volume <strong>宿主机路径(或者匿名的volume 使用命令: <em>docker volume ls</em> 可查看所有volume,使用命令: <em>docker inspect [volume]</em> 查看文件内容):容器路径 将容器内部文件映射到宿主机目录下</strong></li></ul></li></ol></li><li><ol start="3"><li><p>查看容器运行状态&amp;进入容器内部</p><blockquote><p>查看容器运行状态</p></blockquote><p><img src="Docker-部署安装Confluence_files/2.jpg" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a</span><br></pre></td></tr></table></figure><blockquote><p>进入容器内部,退出: <strong>exit</strong></p></blockquote><p><img src="Docker-部署安装Confluence_files/4.jpg" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it [容器名或者ID] /bin/sh</span><br></pre></td></tr></table></figure></li></ol></li><li><ol start="4"><li><p>配置confluence</p><ul><li>访问<a href="http://ip:7788">http://ip:7788</a> 就可以看到Confluence的初始化和配置页面。右上角语言栏选择中文</li></ul><p><img src="Docker-部署安装Confluence_files/5.jpg" alt><br><img src="Docker-部署安装Confluence_files/3.jpg" alt></p><ul><li>一路next</li></ul><p><img src="Docker-部署安装Confluence_files/6.jpg" alt></p><ul><li><p id="继续安装">记住这个服务ID,进入破解流程:<br><a href="#confluence破解" target="_self">confluence破解</a></p></li><li><p>输入上一步破解教程得到的Key  </p></li></ul><p><img src="Docker-部署安装Confluence_files/11.jpg" alt>    </p><ul><li>开始配置数据库  </li></ul><p><img src="Docker-部署安装Confluence_files/12.jpg" alt></p><p><img src="Docker-部署安装Confluence_files/10.jpg" alt></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbc:mysql://192.168.1.202:3308/test_confluence?useUnicode=true&amp;amp;characterEncoding=utf8&amp;amp;useSSL=false&amp;amp;sessionVariables=tx_isolation=&apos;READ-COMMITTED&apos;</span><br></pre></td></tr></table></figure><p>如果出现隔离级别错误,设置数据库默认隔离级别为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET GLOBAL TRANSACTION ISOLATION LEVEL READ COMMITTED;</span><br></pre></td></tr></table></figure><ul><li>confluence开始创建表<br><img src="Docker-部署安装Confluence_files/13.jpg" alt></li><li>完成安装<br><img src="Docker-部署安装Confluence_files/14.jpg" alt><br><strong>个人推荐选择空白站点</strong></li></ul></li></ol></li></ul><h2 id="confluence破解"><a href="#confluence破解" class="headerlink" title="confluence破解"></a>confluence破解</h2><ul><li><ol><li>破解文件下载:<br><a href="https://github.com/howard1994/MyFile/raw/master/confluence%E7%A0%B4%E8%A7%A3.rar">confluence破解.rar</a></li></ol></li><li><ol start="2"><li>破解文件的使用:</li></ol><ul><li>(1). 解压文件<br>  <img src="Docker-部署安装Confluence_files/7.jpg" alt><br>   如上图所示图片,邮件打开方式选择java<br>  <img src="Docker-部署安装Confluence_files/8.jpg" alt>  </li><li><p>(2). 破解文件下载到windows机器<br>将atlassian-extras-decoder-v2-3.4.1.jar复制到宿主机并重命名为atlassian-extras-2.4.jar(破解文件只识别此名字)<br>sz 命令将atlassian-extras-2.4.jar 下载到本地进行破解</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker cp  confluence:/opt/atlassian/confluence/confluence/WEB-INF/lib/atlassian-extras-decoder-v2-3.4.1.jar ./atlassian-extras-2.4.jar</span><br><span class="line"> </span><br><span class="line">sz atlassian-extras-2.4.jar</span><br></pre></td></tr></table></figure></li><li><p>(3).破解<br><img src="Docker-部署安装Confluence_files/9.jpg" alt></p><ul><li>将生成的atlassian-extras-2.4.jar上传到服务器(如linux路径下有同名文件需要先重命名)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rz</span><br></pre></td></tr></table></figure></li></ul><p>选择atlassian-extras-2.4.jar进行上传  </p><ul><li><p>用上传的文件替换confluence中的atlassian-extras-decoder-v2-3.4.1.jar</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp ./atlassian-extras-2.4.jar confluence:/opt/atlassian/confluence/confluence/WEB-INF/lib/atlassian-extras-decoder-v2-3.4.1.jar</span><br></pre></td></tr></table></figure></li><li><p>重启容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart confluence</span><br></pre></td></tr></table></figure></li><li><p>复制破解脚本中Key值,重新进入<a href="#继续安装" target="_self">confluence安装教程</a></p><h3 id="常见错误处理"><a href="#常见错误处理" class="headerlink" title="常见错误处理"></a>常见错误处理</h3></li></ul></li></ul></li><li><ol><li>Mysql Session isolation level 错误<blockquote><p>数据库链接中加入参数:<br>useSSL=false</p></blockquote></li></ol></li><li><ol start="2"><li>mysql重启导致隔离级别需要重新设置<blockquote><p>数据库链接中加入参数:<br>sessionVariables=tx_isolation=’READ-COMMITTED’</p></blockquote></li></ol></li></ul>]]></content>
      
      
      <categories>
          
          <category> confluence </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>&#39;Java基础-基本数据类型&#39;</title>
      <link href="/2019/11/11/Java%E5%9F%BA%E7%A1%80-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/"/>
      <url>/2019/11/11/Java%E5%9F%BA%E7%A1%80-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Java基本结构及基本数据类型"><a href="#Java基本结构及基本数据类型" class="headerlink" title="Java基本结构及基本数据类型"></a>Java基本结构及基本数据类型</h1><blockquote><p>基本结构大致分为包、类、main()方法、标识符、关键字、语句、注释等<br><a id="more"></a><br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">package com.howard.test;</span><br><span class="line"></span><br><span class="line">public class Main &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        /* 整数类型 */</span><br><span class="line">        byte myByte = 45;               // byte型变量，占一个字节，取值范围-128~127</span><br><span class="line">        short myShort = 100;            // short型变量，也即短整型，占两个字节，取值范围-32768~32767</span><br><span class="line">        int myInt = 450;                // int型变量，也即整型，占四个字节，取值范围-2147483648~2147483647</span><br><span class="line">        long myLong = 45261636L;        // long型变量，也即长整型，占八个字节，取值范围-9223372036854775808~9223372036854775807</span><br><span class="line"></span><br><span class="line">        /* 浮点类型 */</span><br><span class="line">        float myFloat = 15.621F;        // 单精度浮点型，占四个字节，结尾必须加&apos;F&apos;或&apos;f&apos;，如果不加自动定义为double型变量，取值范围1.4E-45~3.4028235E-38</span><br><span class="line">        double myDouble = 15.621D;      // 双精度浮点型，占八个字节，结尾可以加&apos;D&apos;或&apos;d&apos;，也可不加，取值范围4.9E-324~1.7976931348623157E-308</span><br><span class="line"></span><br><span class="line">        /* 字符类型 */</span><br><span class="line">        char myChar = &apos;a&apos;;              // 字符类型变量，用于存储单个字符，占两个字节，需用单引号括起来</span><br><span class="line"></span><br><span class="line">        /* 布尔类型 */</span><br><span class="line">        boolean myBoolean = true;       // 布尔类型又称逻辑类型，只有true和false两个值，分别代表“真”和“假”</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Java基础 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RabbitMQ配置留档</title>
      <link href="/2019/10/15/Rabbit%E7%95%99%E6%A1%A3/"/>
      <url>/2019/10/15/Rabbit%E7%95%99%E6%A1%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="RabbitMQ消息队列基本操作"><a href="#RabbitMQ消息队列基本操作" class="headerlink" title="RabbitMQ消息队列基本操作"></a>RabbitMQ消息队列基本操作</h1><h2 id="RabbitMQ操作"><a href="#RabbitMQ操作" class="headerlink" title="RabbitMQ操作"></a>RabbitMQ操作</h2><a id="more"></a><p>进入安装目录sbin文件夹下运行,也可以开启web插件,在界面用guest/guest添加账号</p><blockquote><blockquote><p>启动RabbitMQ管理页面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rabbitmq-plugins.bat enable rabbitmq_management</span><br></pre></td></tr></table></figure></p></blockquote></blockquote><blockquote><blockquote><p>删除已安装的RabbitMQ服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rabbitmq-service.bat remove</span><br></pre></td></tr></table></figure></p></blockquote></blockquote><blockquote><blockquote><p>设置新路径<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set RABBITMQ_BASE=D:\RabbitMQ\Data</span><br></pre></td></tr></table></figure></p></blockquote></blockquote><blockquote><blockquote><p>重新安装RabbitMQ服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rabbitmq-service.bat install</span><br></pre></td></tr></table></figure></p></blockquote></blockquote><blockquote><blockquote><p>启动服务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rabbitmq-service.bat start</span><br></pre></td></tr></table></figure></p></blockquote></blockquote><blockquote><blockquote><p>添加用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rabbitmqctl.bat  add_user  rabbitmquser  123456</span><br></pre></td></tr></table></figure></p></blockquote></blockquote><blockquote><blockquote><p>赋角色<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rabbitmqctl.bat  set_user_tags rabbitmquser administrator</span><br></pre></td></tr></table></figure></p></blockquote></blockquote><blockquote><blockquote><p>赋权<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rabbitmqctl.bat  set_permissions -p / rabbitmquser &apos;.*&apos; &apos;.*&apos; &apos;.*&apos;</span><br></pre></td></tr></table></figure></p></blockquote></blockquote><blockquote><blockquote><p>删除默认guest用户<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rabbitmqctl.bat  delete_user  guest</span><br></pre></td></tr></table></figure></p></blockquote></blockquote><h2 id="修改端口号"><a href="#修改端口号" class="headerlink" title="修改端口号"></a>修改端口号</h2><p> Win安装后会在 <code>C:\Users\LongQi-Howard\AppData\Roaming\RabbitMQ</code>生成配置文件.example,修改 <code>tcp_listeners</code> 字段,之后先停止-重装-开启rabbit服务即可修改端口号</p><p> #修改</p>]]></content>
      
      
      <categories>
          
          <category> RabbitMQ </category>
          
          <category> 消息队列 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RabbitMQ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mybatis一对多映射</title>
      <link href="/2019/08/29/mybatis%E4%B8%80%E5%AF%B9%E5%A4%9A%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/"/>
      <url>/2019/08/29/mybatis%E4%B8%80%E5%AF%B9%E5%A4%9A%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul><li>启动类加上MapperScan</li><li>映射文件路径配置要对应到生成的Mapper.xml文件<a id="more"></a><h2 id="application-yml配置文件"><a href="#application-yml配置文件" class="headerlink" title="application.yml配置文件"></a>application.yml配置文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  datasource:</span><br><span class="line">    driver-class-name: com.microsoft.sqlserver.jdbc.SQLServerDriver</span><br><span class="line">    username: sa</span><br><span class="line">    password: longqi.123</span><br><span class="line">    url: jdbc:sqlserver://localhost:8888;database=shiro</span><br><span class="line">mybatis:</span><br><span class="line">  mapper-locations: classpath:mappers/*Mapper.xml</span><br><span class="line">  type-aliases-package: com.howard.shiro.shiro.mappers</span><br></pre></td></tr></table></figure></li></ul><h2 id="mybatis可以根据ResultMap映射一对多"><a href="#mybatis可以根据ResultMap映射一对多" class="headerlink" title="mybatis可以根据ResultMap映射一对多"></a>mybatis可以根据ResultMap映射一对多</h2><blockquote><p>自动生成实体类后,在实体类里添加关联表实体<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">@Data</span><br><span class="line">public class UserInfoEntity &#123;</span><br><span class="line">    private Integer userId;</span><br><span class="line"></span><br><span class="line">    private String userName;</span><br><span class="line"></span><br><span class="line">    private String password;</span><br><span class="line"></span><br><span class="line">    private String salt;</span><br><span class="line"></span><br><span class="line">    private String email;</span><br><span class="line"></span><br><span class="line">    private Integer status;</span><br><span class="line"></span><br><span class="line">    private Date lastLoginTime;</span><br><span class="line"></span><br><span class="line">    private Date createTime;</span><br><span class="line"></span><br><span class="line">    private Date modifyTime;</span><br><span class="line"></span><br><span class="line">    private String activeCode;</span><br><span class="line"></span><br><span class="line">    private Integer deptId;</span><br><span class="line"></span><br><span class="line">    private List&lt;RoleEntity&gt; roles;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote><blockquote><p>在UserMapper.xml的ResultMap标签里配置collection标签<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">UserMapper.xml</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.howard.shiro.shiro.mapper.UserInfoEntityMapper&quot;&gt;</span><br><span class="line"></span><br><span class="line">  &lt;resultMap id=&quot;BaseResultMap&quot; type=&quot;com.howard.shiro.shiro.entity.UserInfoEntity&quot;&gt;</span><br><span class="line">    &lt;id column=&quot;user_id&quot; jdbcType=&quot;INTEGER&quot; property=&quot;userId&quot; /&gt;</span><br><span class="line">    &lt;result column=&quot;user_name&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;userName&quot; /&gt;</span><br><span class="line">    &lt;result column=&quot;password&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;password&quot; /&gt;</span><br><span class="line">    &lt;result column=&quot;salt&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;salt&quot; /&gt;</span><br><span class="line">    &lt;result column=&quot;email&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;email&quot; /&gt;</span><br><span class="line">    &lt;result column=&quot;status&quot; jdbcType=&quot;INTEGER&quot; property=&quot;status&quot; /&gt;</span><br><span class="line">    &lt;result column=&quot;last_login_time&quot; jdbcType=&quot;TIMESTAMP&quot; property=&quot;lastLoginTime&quot; /&gt;</span><br><span class="line">    &lt;result column=&quot;create_time&quot; jdbcType=&quot;TIMESTAMP&quot; property=&quot;createTime&quot; /&gt;</span><br><span class="line">    &lt;result column=&quot;modify_time&quot; jdbcType=&quot;TIMESTAMP&quot; property=&quot;modifyTime&quot; /&gt;</span><br><span class="line">    &lt;result column=&quot;active_code&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;activeCode&quot; /&gt;</span><br><span class="line">    &lt;result column=&quot;dept_id&quot; jdbcType=&quot;INTEGER&quot; property=&quot;deptId&quot; /&gt;</span><br><span class="line">  &lt;/resultMap&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;resultMap id=&quot;BaseRoleResultMap&quot; type=&quot;com.howard.shiro.shiro.entity.RoleEntity&quot;&gt;</span><br><span class="line">    &lt;id column=&quot;role_id&quot; jdbcType=&quot;INTEGER&quot; property=&quot;roleId&quot; /&gt;</span><br><span class="line">    &lt;result column=&quot;role_name&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;roleName&quot; /&gt;</span><br><span class="line">    &lt;result column=&quot;remark&quot; jdbcType=&quot;VARCHAR&quot; property=&quot;remark&quot; /&gt;</span><br><span class="line">    &lt;result column=&quot;create_time&quot; jdbcType=&quot;TIMESTAMP&quot; property=&quot;createTime&quot; /&gt;</span><br><span class="line">    &lt;result column=&quot;modify_time&quot; jdbcType=&quot;TIMESTAMP&quot; property=&quot;modifyTime&quot; /&gt;</span><br><span class="line">  &lt;/resultMap&gt;</span><br><span class="line">  </span><br><span class="line">  &lt;resultMap id=&quot;UserRolePermResultMap&quot; type=&quot;com.howard.shiro.shiro.entity.UserInfoEntity&quot; extends=&quot;BaseResultMap&quot;&gt;</span><br><span class="line">    &lt;collection property=&quot;roles&quot; ofType=&quot;com.howard.shiro.shiro.entity.RoleEntity&quot;</span><br><span class="line">                select=&quot;selectAllRoleByUserId&quot; column=&quot;user_id&quot;/&gt;</span><br><span class="line">&lt;!--extend标识继承 select标签对应子查询语句,column标签对应传递的值 --&gt;</span><br><span class="line">  &lt;/resultMap&gt;</span><br><span class="line">  &lt;sql id=&quot;Base_Column_List&quot;&gt;</span><br><span class="line">    user_id, user_name, password, salt, email, status, last_login_time, create_time, modify_time,</span><br><span class="line">    active_code, dept_id</span><br><span class="line">  &lt;/sql&gt;</span><br><span class="line"></span><br><span class="line">  &lt;sql id=&quot;Base_Role_List&quot;&gt;</span><br><span class="line">    role.role_id, role.role_name, role.remark, role.create_time, role.modify_time</span><br><span class="line">  &lt;/sql&gt;</span><br><span class="line"></span><br><span class="line">  &lt;select id=&quot;selectAllRoleByUserId&quot; resultMap=&quot;BaseRoleResultMap&quot; parameterType=&quot;java.lang.Integer&quot;&gt;</span><br><span class="line">    select</span><br><span class="line">    &lt;include refid=&quot;Base_Role_List&quot;/&gt;</span><br><span class="line">    from</span><br><span class="line">    user_role</span><br><span class="line">    inner join role ON user_role.role_id  = role.role_id</span><br><span class="line">    where</span><br><span class="line">    user_role.user_id = #&#123;user_id&#125;</span><br><span class="line">  &lt;/select&gt;</span><br><span class="line">    &lt;select id=&quot;selectUserInfoRoleByUserName&quot; parameterType=&quot;java.lang.String&quot; resultMap=&quot;UserRolePermResultMap&quot;&gt;</span><br><span class="line">    select</span><br><span class="line">    &lt;include refid=&quot;Base_Column_List&quot;/&gt;</span><br><span class="line">    from</span><br><span class="line">    user_info</span><br><span class="line">    where</span><br><span class="line">    user_name=#&#123;userName&#125;</span><br><span class="line">  &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
          <category> SSM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MyBatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>mybatis逆向生成工程</title>
      <link href="/2019/08/28/mybatis%E9%80%86%E5%90%91%E7%94%9F%E6%88%90/"/>
      <url>/2019/08/28/mybatis%E9%80%86%E5%90%91%E7%94%9F%E6%88%90/</url>
      
        <content type="html"><![CDATA[<h1 id="使用maven插件实现"><a href="#使用maven插件实现" class="headerlink" title="使用maven插件实现"></a>使用maven插件实现</h1><h2 id="pom文件引入依赖"><a href="#pom文件引入依赖" class="headerlink" title="pom文件引入依赖"></a>pom文件引入依赖</h2><a id="more"></a><h3 id="逆向生成依赖"><a href="#逆向生成依赖" class="headerlink" title="逆向生成依赖"></a>逆向生成依赖</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;mybatis-generator-core&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.3.7&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h3 id="逆向生成maven插件"><a href="#逆向生成maven插件" class="headerlink" title="逆向生成maven插件"></a>逆向生成maven插件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">             &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt;</span><br><span class="line">             &lt;artifactId&gt;mybatis-generator-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">             &lt;version&gt;1.3.7&lt;/version&gt;</span><br><span class="line">             &lt;configuration&gt;</span><br><span class="line">                 &lt;configurationFile&gt;</span><br><span class="line">$&#123;basedir&#125;/src/main/resources/generator/generatorConfig.xml</span><br><span class="line">&lt;/configurationFile&gt;</span><br><span class="line">                 &lt;overwrite&gt;true&lt;/overwrite&gt;</span><br><span class="line">                 &lt;verbose&gt;true&lt;/verbose&gt;</span><br><span class="line">             &lt;/configuration&gt;</span><br><span class="line">         &lt;/plugin&gt;</span><br></pre></td></tr></table></figure><blockquote><p>configurationFile逆向工程配置文件地址,地址可以按照自己的想法写</p></blockquote><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE generatorConfiguration</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&quot;&gt;</span><br><span class="line">&lt;generatorConfiguration&gt;</span><br><span class="line">    &lt;!-- 数据库驱动:选择你的本地硬盘上面的数据库驱动包--&gt;</span><br><span class="line">    &lt;classPathEntry location=&quot;C:\Users\LongQi-Howard\Downloads\mssql-jdbc-6.4.0.jre8.jar&quot;/&gt;</span><br><span class="line">    &lt;context id=&quot;DB2Tables&quot; targetRuntime=&quot;MyBatis3&quot;&gt;</span><br><span class="line">        &lt;commentGenerator&gt;</span><br><span class="line">            &lt;property name=&quot;suppressDate&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">            &lt;!-- 是否去除自动生成的注释 true：是 ： false:否 --&gt;</span><br><span class="line">            &lt;property name=&quot;suppressAllComments&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">        &lt;/commentGenerator&gt;</span><br><span class="line">        &lt;!--数据库链接URL，用户名、密码 --&gt;</span><br><span class="line">        &lt;jdbcConnection driverClass=&quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot;</span><br><span class="line">                        connectionURL=&quot;jdbc:sqlserver://218.28.44.115:8888;database=shiro&quot; userId=&quot;sa&quot;</span><br><span class="line">                        password=&quot;longqi.123&quot;&gt;</span><br><span class="line">        &lt;/jdbcConnection&gt;</span><br><span class="line">        &lt;javaTypeResolver&gt;</span><br><span class="line">            &lt;property name=&quot;forceBigDecimals&quot; value=&quot;false&quot;/&gt;</span><br><span class="line">        &lt;/javaTypeResolver&gt;</span><br><span class="line">        &lt;!-- 生成实体类的包名和位置--&gt;</span><br><span class="line">        &lt;javaModelGenerator targetPackage=&quot;com.howard.shiro.shiro.entity&quot; targetProject=&quot;src/main/java&quot;&gt;</span><br><span class="line">            &lt;!-- enableSubPackages:是否让schema作为包的后缀 --&gt;</span><br><span class="line">            &lt;property name=&quot;enableSubPackages&quot; value=&quot;false&quot;/&gt;</span><br><span class="line">            &lt;!-- 从数据库返回的值被清理前后的空格 --&gt;</span><br><span class="line">            &lt;property name=&quot;trimStrings&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">        &lt;/javaModelGenerator&gt;</span><br><span class="line">        &lt;!-- 生成Mapper.xml的包名和位置--&gt;</span><br><span class="line">        &lt;sqlMapGenerator targetPackage=&quot;mappers&quot; targetProject=&quot;./src/main/resources&quot;&gt;</span><br><span class="line">            &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">        &lt;/sqlMapGenerator&gt;</span><br><span class="line">        &lt;!-- 生成mapper接口的位置--&gt;</span><br><span class="line">        &lt;javaClientGenerator type=&quot;XMLMAPPER&quot; targetPackage=&quot;com.howard.shiro.shiro.mapper&quot;</span><br><span class="line">                             targetProject=&quot;src/main/java&quot;&gt;</span><br><span class="line">            &lt;property name=&quot;enableSubPackages&quot; value=&quot;true&quot;/&gt;</span><br><span class="line">        &lt;/javaClientGenerator&gt;</span><br><span class="line">        &lt;!-- 要生成的表 tableName是数据库中的表名或视图名 domainObjectName是实体类名--&gt;</span><br><span class="line">&lt;!--        &lt;table tableName=&quot;user_info&quot; domainObjectName=&quot;UserInfoEntity&quot;--&gt;</span><br><span class="line">&lt;!--               enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               selectByExampleQueryId=&quot;false&quot;&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;/table&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;table tableName=&quot;user_role&quot; domainObjectName=&quot;UserRoleEntity&quot;--&gt;</span><br><span class="line">&lt;!--               enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               selectByExampleQueryId=&quot;false&quot;&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;/table&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;table tableName=&quot;role_operator&quot; domainObjectName=&quot;RoleOperatorEntity&quot;--&gt;</span><br><span class="line">&lt;!--               enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               selectByExampleQueryId=&quot;false&quot;&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;/table&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;table tableName=&quot;role_menu&quot; domainObjectName=&quot;RoleMenuEntity&quot;--&gt;</span><br><span class="line">&lt;!--               enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               selectByExampleQueryId=&quot;false&quot;&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;/table&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;table tableName=&quot;role&quot; domainObjectName=&quot;RoleEntity&quot;--&gt;</span><br><span class="line">&lt;!--               enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               selectByExampleQueryId=&quot;false&quot;&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;/table&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;table tableName=&quot;operator&quot; domainObjectName=&quot;OperatorEntity&quot;--&gt;</span><br><span class="line">&lt;!--               enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               selectByExampleQueryId=&quot;false&quot;&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;/table&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;table tableName=&quot;menu&quot; domainObjectName=&quot;MenuEntity&quot;--&gt;</span><br><span class="line">&lt;!--               enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               selectByExampleQueryId=&quot;false&quot;&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;/table&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;table tableName=&quot;dept&quot; domainObjectName=&quot;DeptEntity&quot;--&gt;</span><br><span class="line">&lt;!--               enableCountByExample=&quot;false&quot; enableUpdateByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               enableDeleteByExample=&quot;false&quot; enableSelectByExample=&quot;false&quot;--&gt;</span><br><span class="line">&lt;!--               selectByExampleQueryId=&quot;false&quot;&gt;--&gt;</span><br><span class="line">&lt;!--        &lt;/table&gt;--&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/context&gt;</span><br><span class="line">&lt;/generatorConfiguration&gt;</span><br></pre></td></tr></table></figure><blockquote><p>然后运行maven插件下的 mybatis-generator:generator <img src="mybatis逆向生成_files/1.jpg" alt></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
          <category> SSM </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MyBatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>shiro配置留档</title>
      <link href="/2019/08/28/SpringBoot+Shiro/"/>
      <url>/2019/08/28/SpringBoot+Shiro/</url>
      
        <content type="html"><![CDATA[<h1 id="Shiro配置"><a href="#Shiro配置" class="headerlink" title="Shiro配置"></a>Shiro配置</h1><h2 id="shiro核心配置类"><a href="#shiro核心配置类" class="headerlink" title="shiro核心配置类"></a>shiro核心配置类</h2><h3 id="MyShiroRealm"><a href="#MyShiroRealm" class="headerlink" title="MyShiroRealm"></a>MyShiroRealm</h3><blockquote><p>继承 AuthorizingRealm 重写doGetAuthorizationInfo(授权),doGetAuthenticationInfo(鉴权)方法<br><a id="more"></a></p><blockquote><p>MyShiroRealm<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * create by: liumeng</span></span><br><span class="line"><span class="comment"> * description: 授权</span></span><br><span class="line"><span class="comment"> * create time: 2019/8/29 14:21</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ： principalCollection</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> : org.apache.shiro.authz.AuthorizationInfo</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> AuthorizationInfo <span class="title">doGetAuthorizationInfo</span><span class="params">(PrincipalCollection principalCollection)</span> </span>&#123;</span><br><span class="line">    UserInfoEntity user = (UserInfoEntity) principalCollection.getPrimaryPrincipal();</span><br><span class="line">    String userName = user.getUserName();</span><br><span class="line">    UserInfoEntity userInfoEntity = userService.getAllUserInfoByUserName(userName);</span><br><span class="line">    Set&lt;String&gt; roles = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">    Set&lt;String&gt; perms = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (RoleEntity roleEntity :</span><br><span class="line">            userInfoEntity.getRoles()) &#123;</span><br><span class="line">        roles.add(roleEntity.getRoleName());</span><br><span class="line">        <span class="keyword">for</span> (MenuEntity menu :</span><br><span class="line">                roleEntity.getMenus()) &#123;</span><br><span class="line">            perms.add(menu.getPerms());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (OperatorEntity operatorEntity :</span><br><span class="line">                roleEntity.getOperators()) &#123;</span><br><span class="line">            perms.add(operatorEntity.getPerms());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    SimpleAuthorizationInfo authorizationInfo = <span class="keyword">new</span> SimpleAuthorizationInfo();</span><br><span class="line">    authorizationInfo.setRoles(roles);</span><br><span class="line">    authorizationInfo.setStringPermissions(perms);</span><br><span class="line">    <span class="keyword">return</span> authorizationInfo;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * create by: liumeng</span></span><br><span class="line"><span class="comment"> * description: 鉴权</span></span><br><span class="line"><span class="comment"> * create time: 2019/8/29 15:11</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> ： authenticationToken</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@return</span> : org.apache.shiro.authc.AuthenticationInfo</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> AuthenticationInfo <span class="title">doGetAuthenticationInfo</span><span class="params">(AuthenticationToken authenticationToken)</span> <span class="keyword">throws</span> AuthenticationException </span>&#123;</span><br><span class="line">    String userName = (String) authenticationToken.getPrincipal();</span><br><span class="line">    UserInfoEntity userInfoEntity = userService.getUserInfoByUserName(userName);</span><br><span class="line">    <span class="keyword">if</span> (userInfoEntity == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnknownAccountException(<span class="string">"账号不存在"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (userInfoEntity.getStatus() == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> LockedAccountException(<span class="string">"账号被锁定"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> SimpleAuthenticationInfo(userInfoEntity, userInfoEntity.getPassword(),</span><br><span class="line">            ByteSource.Util.bytes(userInfoEntity.getSalt()), <span class="keyword">super</span>.getName());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote></blockquote><blockquote><blockquote><p>userService<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> UserInfoEntityMapper userMapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> RoleEntityMapper roleMapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> OperatorEntityMapper operatorMapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> MenuEntityMapper menuMapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value</span>(<span class="string">"$&#123;shiro.admin&#125;"</span>)</span><br><span class="line"><span class="keyword">private</span> String adminUser;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> UserInfoEntity <span class="title">getAllUserInfoByUserName</span><span class="params">(String userName)</span> </span>&#123;</span><br><span class="line">    UserInfoEntity userInfoEntity = userMapper.selectAllUserInfoByUserName(userName);</span><br><span class="line">    <span class="keyword">if</span> (userName.equals(adminUser))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//超级管理员账号获取所有角色和权限</span></span><br><span class="line">        List&lt;RoleEntity&gt; roleEntities = roleMapper.selectAllRoles();</span><br><span class="line">        List&lt;MenuEntity&gt; menuEntities = menuMapper.selectAllMenu();</span><br><span class="line">        List&lt;OperatorEntity&gt; operatorEntities = operatorMapper.selectAllOperator();</span><br><span class="line">        roleEntities.get(<span class="number">0</span>).setMenus(menuEntities);</span><br><span class="line">        roleEntities.get(<span class="number">0</span>).setOperators(operatorEntities);</span><br><span class="line">        userInfoEntity.setRoles(roleEntities);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> userInfoEntity;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> UserInfoEntity <span class="title">getUserInfoByUserName</span><span class="params">(String userName)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> userMapper.selectUserInfoByUserName(userName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote></blockquote><h3 id="ShiroConfig"><a href="#ShiroConfig" class="headerlink" title="ShiroConfig"></a>ShiroConfig</h3><blockquote><blockquote><p>shiro核心配置类</p></blockquote></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * create by: liumeng</span></span><br><span class="line"><span class="comment">    * description: 开启thymeleaf shiro标签 支持</span></span><br><span class="line"><span class="comment">    * create time: 2019/8/29 15:19</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ：</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> : at.pollux.thymeleaf.shiro.dialect.ShiroDialect</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> ShiroDialect <span class="title">shiroDialect</span><span class="params">()</span></span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> ShiroDialect();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * create by: liumeng</span></span><br><span class="line"><span class="comment">    * description: 密码匹配器</span></span><br><span class="line"><span class="comment">    * create time: 2019/8/29 14:14</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ：</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> : org.apache.shiro.authc.credential.HashedCredentialsMatcher</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> HashedCredentialsMatcher <span class="title">hashedCredentialsMatcher</span><span class="params">()</span></span>&#123;</span><br><span class="line">       HashedCredentialsMatcher hashedCredentialsMatcher = <span class="keyword">new</span> HashedCredentialsMatcher();</span><br><span class="line">       hashedCredentialsMatcher.setHashAlgorithmName(<span class="string">"md5"</span>);</span><br><span class="line">       <span class="comment">//散列次数</span></span><br><span class="line">       hashedCredentialsMatcher.setHashIterations(<span class="number">2</span>);</span><br><span class="line">       <span class="keyword">return</span> hashedCredentialsMatcher;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * create by: liumeng</span></span><br><span class="line"><span class="comment">    * description: 自定义Shiro域</span></span><br><span class="line"><span class="comment">    * create time: 2019/8/29 15:16</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ：</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> : com.shiro.howard.lm.config.MyShiroRealm</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> MyShiroRealm <span class="title">myShiroRealm</span><span class="params">()</span></span>&#123;</span><br><span class="line">       MyShiroRealm myShiroRealm = <span class="keyword">new</span> MyShiroRealm();</span><br><span class="line">       <span class="comment">//注入自定义密码匹配器</span></span><br><span class="line">       myShiroRealm.setCredentialsMatcher(hashedCredentialsMatcher());</span><br><span class="line">       <span class="keyword">return</span> myShiroRealm;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * create by: liumeng</span></span><br><span class="line"><span class="comment">    * description: 注入securityManager</span></span><br><span class="line"><span class="comment">    * create time: 2019/8/29 15:18</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ：</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> : org.apache.shiro.mgt.SecurityManager</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> SecurityManager <span class="title">securityManager</span><span class="params">()</span></span>&#123;</span><br><span class="line">       DefaultWebSecurityManager securityManager = <span class="keyword">new</span> DefaultWebSecurityManager();</span><br><span class="line">       securityManager.setRealm(myShiroRealm());</span><br><span class="line">       <span class="keyword">return</span> securityManager;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * create by: liumeng</span></span><br><span class="line"><span class="comment">    * description: 配置Shiro过滤规则</span></span><br><span class="line"><span class="comment">    * create time: 2019/8/29 15:22</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ： securityManager</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> : org.apache.shiro.spring.web.ShiroFilterFactoryBean</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> ShiroFilterFactoryBean <span class="title">shiroFilterFactoryBean</span><span class="params">(SecurityManager securityManager)</span></span>&#123;</span><br><span class="line">       ShiroFilterFactoryBean shiroFilterFactoryBean = <span class="keyword">new</span> ShiroFilterFactoryBean();</span><br><span class="line">       shiroFilterFactoryBean.setSecurityManager(securityManager);</span><br><span class="line">       <span class="comment">//配置拦截器</span></span><br><span class="line">       Map&lt;String,String&gt; filterMap = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line">       filterMap.put(<span class="string">"/favicon.ico"</span>, <span class="string">"anon"</span>);</span><br><span class="line">       filterMap.put(<span class="string">"/css/**"</span>, <span class="string">"anon"</span>);</span><br><span class="line">       filterMap.put(<span class="string">"/fonts/**"</span>, <span class="string">"anon"</span>);</span><br><span class="line">       filterMap.put(<span class="string">"/images/**"</span>, <span class="string">"anon"</span>);</span><br><span class="line">       filterMap.put(<span class="string">"/js/**"</span>, <span class="string">"anon"</span>);</span><br><span class="line">       filterMap.put(<span class="string">"/lib/**"</span>, <span class="string">"anon"</span>);</span><br><span class="line">       filterMap.put(<span class="string">"/login"</span>, <span class="string">"anon"</span>);</span><br><span class="line">       filterMap.put(<span class="string">"/register"</span>, <span class="string">"anon"</span>);</span><br><span class="line">       filterMap.put(<span class="string">"/403"</span>, <span class="string">"anon"</span>);</span><br><span class="line">       filterMap.put(<span class="string">"/404"</span>, <span class="string">"anon"</span>);</span><br><span class="line">       filterMap.put(<span class="string">"/500"</span>, <span class="string">"anon"</span>);</span><br><span class="line">       filterMap.put(<span class="string">"/error"</span>, <span class="string">"anon"</span>);</span><br><span class="line">       filterMap.put(<span class="string">"/login"</span>,<span class="string">"anon"</span>);</span><br><span class="line">       filterMap.put(<span class="string">"/logout"</span>,<span class="string">"logout"</span>);</span><br><span class="line">       filterMap.put(<span class="string">"/**"</span>,<span class="string">"authc"</span>);</span><br><span class="line">       shiroFilterFactoryBean.setLoginUrl(<span class="string">"/login"</span>);</span><br><span class="line">       shiroFilterFactoryBean.setSuccessUrl(<span class="string">"/index"</span>);</span><br><span class="line">       shiroFilterFactoryBean.setUnauthorizedUrl(<span class="string">"/403"</span>);</span><br><span class="line">       shiroFilterFactoryBean.setFilterChainDefinitionMap(filterMap);</span><br><span class="line">       <span class="keyword">return</span> shiroFilterFactoryBean;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * create by: liumeng</span></span><br><span class="line"><span class="comment">    * description: 开启AOP注解</span></span><br><span class="line"><span class="comment">    * create time: 2019/8/29 15:24</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ： securityManager</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> : org.apache.shiro.spring.security.interceptor.AuthorizationAttributeSourceAdvisor</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> AuthorizationAttributeSourceAdvisor <span class="title">authorizationAttributeSourceAdvisor</span><span class="params">(SecurityManager securityManager)</span></span>&#123;</span><br><span class="line">       AuthorizationAttributeSourceAdvisor authorizationAttributeSourceAdvisor = <span class="keyword">new</span> AuthorizationAttributeSourceAdvisor();</span><br><span class="line">       authorizationAttributeSourceAdvisor.setSecurityManager(securityManager);</span><br><span class="line">       <span class="keyword">return</span> authorizationAttributeSourceAdvisor;</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * create by: liumeng</span></span><br><span class="line"><span class="comment">    * description: 扫描上下文，寻找所有的Advistor(通知器）</span></span><br><span class="line"><span class="comment">    *              将这些Advisor应用到所有符合切入点的Bean中。</span></span><br><span class="line"><span class="comment">    * create time: 2019/8/29 15:25</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ： </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> : org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> DefaultAdvisorAutoProxyCreator <span class="title">defaultAdvisorAutoProxyCreator</span><span class="params">()</span></span>&#123;</span><br><span class="line">       DefaultAdvisorAutoProxyCreator defaultAdvisorAutoProxyCreator=<span class="keyword">new</span> DefaultAdvisorAutoProxyCreator();</span><br><span class="line">       defaultAdvisorAutoProxyCreator.setProxyTargetClass(<span class="keyword">true</span>);</span><br><span class="line">       <span class="keyword">return</span> defaultAdvisorAutoProxyCreator;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> SpringBoot </category>
          
          <category> Shiro </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Shiro </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>库存同步</title>
      <link href="/2019/02/25/U8ERP/"/>
      <url>/2019/02/25/U8ERP/</url>
      
        <content type="html"><![CDATA[<h1 id="库存同步"><a href="#库存同步" class="headerlink" title="库存同步"></a>库存同步</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>公司自研<strong>ORP(订单资源管理平台)</strong>上线后，公司对库存的管理做了相应的调整,工厂使用用友U8系统进行生产和成品库存管理，销售公司订单部进行销售发货是使用公司自研的订单ERP系统完成货运匹配、订单处理、打包发货等操作.为了实现两套系统中的库存同步，在各自系统中建立了同样的仓库，并靠人工每天将产生的订单进行导入或录入达到库存同步的目的,这种库存同步的方式耗费人工的且库存时效性低，因此需进行系统之间的数据集成，达到数据时效性和降低人工成本的目的<br><a id="more"></a></p><h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><p>在保证系统稳定的前提下实现库存的自动同步,提高同步的时效性</p><h2 id="技术选取"><a href="#技术选取" class="headerlink" title="技术选取"></a>技术选取</h2><p>1.U8到中间件的数据同步,采用数据库触发器的方式写入中间件数据库.当有新数据插入的时候会触发触发器,开始往中间件数据库写入数据.<br>2.为了保证数据传输的可靠性,中间件与ORP的通信采用消息队列方式实现,并开启ACK验证,消息持久化.</p><h2 id="系统时序图"><a href="#系统时序图" class="headerlink" title="系统时序图"></a>系统时序图</h2><h3 id="U8同步库存到ERP序列图"><a href="#U8同步库存到ERP序列图" class="headerlink" title="U8同步库存到ERP序列图"></a>U8同步库存到ERP序列图</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">participant U8</span><br><span class="line">participant 中间件</span><br><span class="line">participant ERP</span><br><span class="line">U8-&gt;&gt;中间件:新的出入库记录(排除ERP同步订单)</span><br><span class="line">中间件-&gt;&gt;ERP:发送新的库存变更记录</span><br><span class="line">ERP-&gt;&gt;中间件:返回同步结果</span><br><span class="line">note left of 中间件:更新中间件数据库状态</span><br></pre></td></tr></table></figure><h3 id="ERP出入库记录同步到U8"><a href="#ERP出入库记录同步到U8" class="headerlink" title="ERP出入库记录同步到U8"></a>ERP出入库记录同步到U8</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line">participant U8</span><br><span class="line">participant 中间件</span><br><span class="line">participant ERP</span><br><span class="line">ERP-&gt;&gt;中间件:出入库记录及详情</span><br><span class="line">中间件-&gt;&gt;U8:调用存储过程在U8数据库生成发货单和出库单</span><br><span class="line">U8-&gt;&gt;中间件:返回单据号和其他信息回写到中间件</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2>]]></content>
      
      
      <categories>
          
          <category> U8库存同步 </category>
          
          <category> 系统设计 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> U8库存同步 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
